<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Doyel Token Deployer</title>
  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
    h1 { color: #333; }
    textarea { width: 100%; height: 150px; margin-bottom: 10px; }
    input, button { padding: 10px; margin-top: 10px; width: 100%; }
    #status { margin-top: 20px; color: green; }
  </style>
</head>
<body>
  <h1>Doyel Token Deployer (tBNB/BSC)</h1>

  <label for="admin">Admin Address:</label>
  <input type="text" id="admin" placeholder="0x...">

  <label for="abi">ABI (paste content of ABI.txt):</label>
  <textarea id="abi" placeholder="ABI JSON here"></textarea>

  <label for="bytecode">Bytecode (paste content of Bytecode.txt):</label>
  <textarea id="bytecode" placeholder="0x..."></textarea>

  <button id="deployBtn">Deploy Token</button>

  <div id="status"></div>

  <script>
    const status = document.getElementById('status');
    const deployBtn = document.getElementById('deployBtn');

    deployBtn.addEventListener('click', async () => {
      if (!window.ethereum) {
        alert('MetaMask not detected. Install MetaMask to deploy.');
        return;
      }

      try {
        await ethereum.request({ method: 'eth_requestAccounts' });
        const web3 = new Web3(window.ethereum);
        const accounts = await web3.eth.getAccounts();
        const deployer = accounts[0];

        const adminAddress = document.getElementById('admin').value.trim();
        if (!web3.utils.isAddress(adminAddress)) {
          alert('Invalid admin address');
          return;
        }

        const abiText = document.getElementById('abi').value.trim();
        const bytecodeText = document.getElementById('bytecode').value.trim();

        if (!abiText || !bytecodeText) {
          alert('Please paste ABI and Bytecode.');
          return;
        }

        const abi = JSON.parse(abiText);
        const bytecode = bytecodeText.startsWith('0x') ? bytecodeText : '0x' + bytecodeText;

        const contract = new web3.eth.Contract(abi);

        status.innerHTML = 'Deploying contract... Please confirm MetaMask transaction.';

        const deployed = await contract.deploy({ data: bytecode, arguments: [adminAddress] })
          .send({ from: deployer, gas: 4000000 });

        status.innerHTML = `
          ✅ Contract deployed successfully! <br>
          Address: <b>${deployed.options.address}</b>
        `;
      } catch (err) {
        console.error(err);
        status.innerHTML = '❌ Error: ' + err.message;
      }
    });
  </script>
</body>
</html>
